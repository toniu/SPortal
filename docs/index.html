<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SPortal - SharePoint Intranet Portal Demo</title>
  <link rel="icon" type="image/x-icon" href="logos/favicon.ico.png">
  <link rel="apple-touch-icon" href="logos/favicon.ico.png">
  <meta name="theme-color" content="#0078d4">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Segoe+UI:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --sp-blue: #049ca6;
      --sp-blue-dark: #037c85;
      --sp-teal: #00b7c3;
      --sp-bg: #f3f2f1;
      --sp-surface: #fff;
      --sp-border: #e1dfdd;
      --sp-text: #323130;
      --sp-muted: #605e5c;
      --sp-accent: var(--sp-blue);
      --sp-accent-hover: var(--sp-blue-dark);
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;font-family: 'Segoe UI', Inter, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
      background:var(--sp-bg);color:var(--sp-text);line-height:1.6;font-size:1.02rem
    }
    .container{max-width:1100px;margin:0 auto;padding:0 24px}
    header{padding:48px 0 32px;text-align:center;background:var(--sp-surface);border-bottom:1px solid var(--sp-border);box-shadow:0 2px 8px rgba(0,0,0,0.03)}
    .sp-logo{width:64px;height:64px;margin-bottom:12px;border-radius:12px;object-fit:contain;background:#fff}
    header h1{font-size:2rem;color:var(--sp-accent);margin:6px 0}
    header p{color:var(--sp-muted);max-width:640px;margin:8px auto}
    .tech-badge{display:inline-block;background:var(--sp-bg);border:1px solid var(--sp-border);border-radius:6px;padding:4px 12px;font-size:.85rem;color:var(--sp-muted);margin:4px}
    .btn{display:inline-block;margin-top:16px;padding:10px 20px;background:linear-gradient(90deg,var(--sp-accent) 60%,var(--sp-teal) 100%);color:#fff;text-decoration:none;border-radius:28px;font-weight:600}
    nav{position:sticky;top:0;background:var(--sp-surface);border-bottom:1px solid var(--sp-border);z-index:100;padding:10px 0}
    nav .container{display:flex;gap:18px;overflow-x:auto}
    nav a{color:var(--sp-muted);text-decoration:none;white-space:nowrap;padding-bottom:2px}
    nav a:hover{color:var(--sp-accent)}
    nav a svg{vertical-align:middle;margin-right:8px}
    /* Nav spacing and responsive behavior */
    nav a{padding:10px 12px;border-radius:8px;transition:background .18s, color .18s, transform .18s}
    nav a:hover{background:rgba(4,156,166,0.06);transform:translateY(-1px)}
    section{padding:48px 0;border-bottom:1px solid var(--sp-border)}
    section h2{font-size:1.25rem;color:var(--sp-accent);margin-bottom:8px}
    .subtitle{color:var(--sp-muted);margin-bottom:20px}
    .feature-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;margin-bottom:20px}
    .feature-card{background:var(--sp-surface);border:1px solid var(--sp-border);border-radius:10px;padding:14px;font-family:Inter, 'Segoe UI', sans-serif;font-weight:400}
    .media-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:18px}
    .media-item{background:var(--sp-surface);border:1px solid var(--sp-border);border-radius:10px;overflow:hidden}
    .media-item img,.media-item video{width:100%;display:block}
    .media-item .caption{padding:10px 12px;color:var(--sp-muted);font-size:.9rem}
    section h2 svg{vertical-align:middle;margin-right:8px}
    footer{padding:36px 0;text-align:center;color:var(--sp-muted);background:var(--sp-surface);border-top:1px solid var(--sp-border)}
    /* Mobile nav toggle */
    .nav-toggle{display:none;background:transparent;border:0;padding:8px;border-radius:8px;cursor:pointer}
    .nav-toggle svg{width:22px;height:22px;color:var(--sp-muted)}
    nav{position:relative}
    nav .container{transition:transform .28s ease,opacity .22s ease}
    nav.open .container{transform:none;opacity:1}
    @media(max-width:640px){
      header h1{font-size:1.6rem}
      .media-grid{grid-template-columns:1fr}
    }
    @media(max-width:880px){
      /* mobile nav becomes full-width dropdown */
      .nav-toggle{display:inline-block}
      nav .container{position:fixed;left:0;right:0;top:64px;background:var(--sp-surface);flex-direction:column;padding:12px 20px;border-bottom:1px solid var(--sp-border);transform:translateY(-110%);opacity:0;box-shadow:0 8px 20px rgba(0,0,0,0.06)}
      nav.open .container{transform:translateY(0);opacity:1}
      nav .container a{display:block;padding:12px 8px;margin:6px 0}
    }
  </style>
</head>
<body>

<div id="app-root"></div>

<script>
// icons (inline SVGs mapped by section id to avoid extra asset maintenance)
const icons = {
  dashboard: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="8" height="8" rx="1"/><rect x="13" y="3" width="8" height="8" rx="1"/><rect x="13" y="13" width="8" height="8" rx="1"/><rect x="3" y="13" width="8" height="8" rx="1"/></svg>`,
  calendar: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>`,
  groups: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>`,
  polls: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="10" width="4" height="11" rx="1"/><rect x="10" y="6" width="4" height="15" rx="1"/><rect x="17" y="2" width="4" height="19" rx="1"/></svg>`,
  profile: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="7" r="4"/><path d="M5.5 21a8.38 8.38 0 0 1 13 0"/></svg>`,
  github: `<svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.58 2 12.26c0 4.48 2.87 8.28 6.84 9.63.5.09.68-.22.68-.48 0-.24-.01-.87-.01-1.7-2.78.62-3.37-1.36-3.37-1.36-.45-1.18-1.1-1.5-1.1-1.5-.9-.63.07-.62.07-.62 1 .07 1.53 1.05 1.53 1.05.89 1.56 2.34 1.11 2.91.85.09-.66.35-1.11.63-1.37-2.22-.26-4.56-1.14-4.56-5.07 0-1.12.39-2.03 1.03-2.75-.1-.26-.45-1.3.1-2.7 0 0 .84-.28 2.75 1.05A9.38 9.38 0 0 1 12 6.84c.85.004 1.7.12 2.5.34 1.9-1.33 2.74-1.05 2.74-1.05.55 1.4.2 2.44.1 2.7.64.72 1.03 1.63 1.03 2.75 0 3.94-2.34 4.8-4.57 5.06.36.32.68.94.68 1.9 0 1.37-.01 2.47-.01 2.8 0 .26.18.58.69.48A10.01 10.01 0 0 0 22 12.26C22 6.58 17.52 2 12 2Z"/></svg>`
};

// content data — use local release/ paths first with remote raw.github fallback
const rawBase = 'https://raw.githubusercontent.com/toniu/SPortal/main/release/deliverables/demos';
const sections = [
  {
    id: 'dashboard',
    title: 'Dashboard',
    subtitle: "Personalized landing page showing user's recent and upcoming items.",
    features: [
      {title: 'Overview', desc: 'At-a-glance widgets for key items.'},
      {title: 'Activity', desc: 'Recent actions and notifications.'}
    ],
    media: [
      {type: 'img', src: '../release/deliverables/demos/dashboard/screenshots/dashboard.png', remote: rawBase + '/dashboard/screenshots/dashboard.png', alt: 'Dashboard overview', caption: 'Dashboard overview'},
      {type: 'video', mp4: '../release/deliverables/demos/dashboard/demo-videos/dashboard-demo.mp4', mov: '../release/deliverables/demos/dashboard/demo-videos/dashboard-demo.mov', remoteMp4: rawBase + '/dashboard/demo-videos/dashboard-demo.mp4', remoteMov: rawBase + '/dashboard/demo-videos/dashboard-demo.mov', caption: 'Dashboard demo'}
    ]
  },
  {
    id: 'calendar',
    title: 'Calendar',
    subtitle: 'Integrated calendar showing events and meetings.',
    features: [
      {title: 'Monthly view', desc: 'See events across the month.'},
      {title: 'Event details', desc: 'Quick view and join links.'}
    ],
    media: [
      {type:'img', src:'../release/deliverables/demos/calendar/screenshots/add-edit-event.png', remote: rawBase + '/calendar/screenshots/add-edit-event.png', alt:'Add/Edit event', caption:'Add/Edit event'},
      {type:'img', src:'../release/deliverables/demos/calendar/screenshots/delete-event.png', remote: rawBase + '/calendar/screenshots/delete-event.png', alt:'Delete event', caption:'Delete event'},
      {type:'img', src:'../release/deliverables/demos/calendar/screenshots/edit-add-event-ocation-search.png', remote: rawBase + '/calendar/screenshots/edit-add-event-ocation-search.png', alt:'Location search', caption:'Location search'},
      {type:'img', src:'../release/deliverables/demos/calendar/screenshots/edit-add-event-recurrences.png', remote: rawBase + '/calendar/screenshots/edit-add-event-recurrences.png', alt:'Recurrences', caption:'Recurrence settings'},
      {type:'img', src:'../release/deliverables/demos/calendar/screenshots/view-events.png', remote: rawBase + '/calendar/screenshots/view-events.png', alt:'View events', caption:'View events'},
      {type:'video', mp4:'../release/deliverables/demos/calendar/demo-videos/configuration-and-views-demo.mp4', mov:'../release/deliverables/demos/calendar/demo-videos/configuration-and-views-demo.mov', remoteMp4: rawBase + '/calendar/demo-videos/configuration-and-views-demo.mp4', remoteMov: rawBase + '/calendar/demo-videos/configuration-and-views-demo.mov', caption:'Configuration and views demo'},
      {type:'video', mp4:'../release/deliverables/demos/calendar/demo-videos/delete-event-demo.mp4', mov:'../release/deliverables/demos/calendar/demo-videos/delete-event-demo.mov', remoteMp4: rawBase + '/calendar/demo-videos/delete-event-demo.mp4', remoteMov: rawBase + '/calendar/demo-videos/delete-event-demo.mov', caption:'Delete event demo'},
      {type:'video', mp4:'../release/deliverables/demos/calendar/demo-videos/edit-add-event-demo.mp4', mov:'../release/deliverables/demos/calendar/demo-videos/edit-add-event-demo.mov', remoteMp4: rawBase + '/calendar/demo-videos/edit-add-event-demo.mp4', remoteMov: rawBase + '/calendar/demo-videos/edit-add-event-demo.mov', caption:'Edit/Add event demo'},
      {type:'video', mp4:'../release/deliverables/demos/calendar/demo-videos/edit-recurrences-demo.mp4', mov:'../release/deliverables/demos/calendar/demo-videos/edit-recurrences-demo.mov', remoteMp4: rawBase + '/calendar/demo-videos/edit-recurrences-demo.mp4', remoteMov: rawBase + '/calendar/demo-videos/edit-recurrences-demo.mov', caption:'Edit recurrences demo'},
      {type:'video', mp4:'../release/deliverables/demos/calendar/demo-videos/recurrences-demo.mp4', mov:'../release/deliverables/demos/calendar/demo-videos/recurrences-demo.mov', remoteMp4: rawBase + '/calendar/demo-videos/recurrences-demo.mp4', remoteMov: rawBase + '/calendar/demo-videos/recurrences-demo.mov', caption:'Recurrences demo'}
    ]
  },
  {
    id: 'groups',
    title: 'Group Management',
    subtitle: 'Create, browse, join and manage groups backed by SharePoint Lists.',
    features: [
      {title: 'Browse and Filter', desc: 'View all groups with filters.'},
      {title: 'Join and Leave', desc: 'One-click join/leave for public groups.'},
      {title: 'Group CRUD', desc: 'Owners can create and manage groups.'}
    ],
    media: [
      {type:'img', src:'../release/deliverables/demos/group-management/screenshots/view-filter-groups.png', remote: rawBase + '/group-management/screenshots/view-filter-groups.png', alt:'Filter groups', caption:'View and filter groups'},
      {type:'img', src:'../release/deliverables/demos/group-management/screenshots/create-group.png', remote: rawBase + '/group-management/screenshots/create-group.png', alt:'Create group', caption:'Creating a new group'},
      {type:'img', src:'../release/deliverables/demos/group-management/screenshots/edit-group.png', remote: rawBase + '/group-management/screenshots/edit-group.png', alt:'Edit group', caption:'Editing a group'},
      {type:'img', src:'../release/deliverables/demos/group-management/screenshots/join-public-group.png', remote: rawBase + '/group-management/screenshots/join-public-group.png', alt:'Join group', caption:'Joining a public group'},
      {type:'img', src:'../release/deliverables/demos/group-management/screenshots/leave-public-group.png', remote: rawBase + '/group-management/screenshots/leave-public-group.png', alt:'Leave group', caption:'Leaving a group'},
      {type:'img', src:'../release/deliverables/demos/group-management/screenshots/delete-group.png', remote: rawBase + '/group-management/screenshots/delete-group.png', alt:'Delete group', caption:'Delete group confirmation'},
      {type:'video', mp4:'../release/deliverables/demos/group-management/demo-videos/create-group-demo.mp4', mov:'../release/deliverables/demos/group-management/demo-videos/create-group-demo.mov', remoteMp4: rawBase + '/group-management/demo-videos/create-group-demo.mp4', remoteMov: rawBase + '/group-management/demo-videos/create-group-demo.mov', caption:'Creating a new group'},
      {type:'video', mp4:'../release/deliverables/demos/group-management/demo-videos/join-leave-filter-groups-demo.mp4', mov:'../release/deliverables/demos/group-management/demo-videos/join-leave-filter-groups-demo.mov', remoteMp4: rawBase + '/group-management/demo-videos/join-leave-filter-groups-demo.mp4', remoteMov: rawBase + '/group-management/demo-videos/join-leave-filter-groups-demo.mov', caption:'Joining, leaving and filtering groups'},
      {type:'video', mp4:'../release/deliverables/demos/group-management/demo-videos/edit-group-demo.mp4', mov:'../release/deliverables/demos/group-management/demo-videos/edit-group-demo.mov', remoteMp4: rawBase + '/group-management/demo-videos/edit-group-demo.mp4', remoteMov: rawBase + '/group-management/demo-videos/edit-group-demo.mov', caption:'Editing a group'},
      {type:'video', mp4:'../release/deliverables/demos/group-management/demo-videos/delete-group-demo.mp4', mov:'../release/deliverables/demos/group-management/demo-videos/delete-group-demo.mov', remoteMp4: rawBase + '/group-management/demo-videos/delete-group-demo.mp4', remoteMov: rawBase + '/group-management/demo-videos/delete-group-demo.mov', caption:'Deleting a group'}
    ]
  },
  {
    id: 'polls',
    title: 'Poll Management',
    subtitle: 'Vote on polls and view results with chart analytics.',
    features: [
      {title: 'One-Click Voting', desc: 'Submit a vote quickly.'},
      {title: 'Chart Analytics', desc: 'View aggregated results.'}
    ],
    media: [
      {type:'img', src:'../release/deliverables/demos/poll-management/screenshots/poll-analytics.png', remote: rawBase + '/poll-management/screenshots/poll-analytics.png', alt:'Poll analytics', caption:'Poll results analytics'},
      {type:'img', src:'../release/deliverables/demos/poll-management/screenshots/poll-vote.png', remote: rawBase + '/poll-management/screenshots/poll-vote.png', alt:'Poll vote', caption:'Casting a vote'},
      {type:'img', src:'../release/deliverables/demos/poll-management/screenshots/preferred-chart-type.png', remote: rawBase + '/poll-management/screenshots/preferred-chart-type.png', alt:'Chart type', caption:'Preferred chart type'},
      {type:'video', mp4:'../release/deliverables/demos/poll-management/demo-videos/poll-vote-analytics-demo.mp4', mov:'../release/deliverables/demos/poll-management/demo-videos/poll-vote-analytics-demo.mov', remoteMp4: rawBase + '/poll-management/demo-videos/poll-vote-analytics-demo.mp4', remoteMov: rawBase + '/poll-management/demo-videos/poll-vote-analytics-demo.mov', caption:'Voting and viewing analytics'},
      {type:'video', mp4:'../release/deliverables/demos/poll-management/demo-videos/poll-configuration-demo.mp4', mov:'../release/deliverables/demos/poll-management/demo-videos/poll-configuration-demo.mov', remoteMp4: rawBase + '/poll-management/demo-videos/poll-configuration-demo.mp4', remoteMov: rawBase + '/poll-management/demo-videos/poll-configuration-demo.mov', caption:'Poll configuration'}
    ]
  },
  {
    id: 'profile',
    title: 'Profile',
    subtitle: 'User profile card with suggested connections.',
    features: [
      {title: 'Profile Card', desc: 'Shows user details and memberships.'},
      {title: 'Suggestions', desc: 'People you might know.'}
    ],
    media: [
      {type:'img', src:'../release/deliverables/demos/profile/screenshots/profile.png', remote: rawBase + '/profile/screenshots/profile.png', alt:'Profile', caption:'User profile'},
      {type:'video', mp4:'../release/deliverables/demos/profile/demo-videos/profile-demo.mp4', mov:'../release/deliverables/demos/profile/demo-videos/profile-demo.mov', remoteMp4: rawBase + '/profile/demo-videos/profile-demo.mp4', remoteMov: rawBase + '/profile/demo-videos/profile-demo.mov', caption:'Profile walkthrough'}
    ]
  }
];

const techBadges = ["SPFx 1.16","TypeScript","React","PnPjs","Office UI Fabric","Jest"];

// render
const app = document.getElementById('app-root');
app.innerHTML = `
  <header>
    <div class="container">
      <img src="logos/sp-logo.png" alt="SPortal" class="sp-logo" />
      <h1>SPortal</h1>
      <p>A suite of SharePoint Framework web parts forming an intranet portal — calendar, dashboard, groups, polls and profiles.</p>
      <div>${techBadges.map(b=>`<span class="tech-badge">${b}</span>`).join('')}</div>
      <a class="btn" href="https://github.com/toniu/SPortal" target="_blank" rel="noopener">${icons.github} View on GitHub</a>
    </div>
  </header>

  <nav>
    <button id="nav-toggle" class="nav-toggle" aria-expanded="false" aria-label="Toggle navigation">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7h18M3 12h18M3 17h18"/></svg>
    </button>
    <div class="container">
      ${sections.map(s=>`<a href="#${s.id}">${icons[s.id]||''}<span style="margin-left:6px">${s.title}</span></a>`).join('')}
    </div>
  </nav>

  ${sections.map(s=>`
    <section id="${s.id}">
      <div class="container">
        <h2>${icons[s.id]||''}<span style="margin-left:8px">${s.title}</span></h2>
        <p class="subtitle">${s.subtitle}</p>
        <div class="feature-grid">
          ${s.features.map(f=>`<div class="feature-card"><h3 style="font-weight:600">${f.title}</h3><p style="font-weight:400">${f.desc}</p></div>`).join('')}
        </div>
        <div class="media-grid">
          ${s.media.map(m=> m.type === 'img' ?
            `<div class="media-item"><img src="${m.src}" alt="${m.alt}" onerror="this.onerror=null;this.src='${m.remote||('https://via.placeholder.com/800x450?text=Image+missing')}'"><div class="caption">${m.caption}</div></div>` :
            `<div class="media-item"><video controls muted playsinline preload="metadata" onerror="this.onerror=null;this.outerHTML='<div class=&quot;media-item&quot;><img src=&quot;${m.remoteMp4||m.remote||'https://via.placeholder.com/800x450?text=Video+unavailable'}&quot; alt=&quot;Video unavailable&quot;><div class=&quot;caption&quot;>${m.caption}</div></div>'"><source src="${m.mp4}" type="video/mp4"><source src="${m.mov}" type="video/quicktime"></video><div class="caption">${m.caption}</div></div>`).join('')}
        </div>
      </div>
    </section>
  `).join('')}

  <footer>
    <div class="container"><p>Built by <a href="https://github.com/toniu">Neka Toni-Uebari</a> · <a href="https://github.com/toniu/SPortal">Source on GitHub</a></p></div>
  </footer>
`;
// wire up mobile nav toggle and auto-close on link click
const navToggle = document.getElementById('nav-toggle');
const navEl = document.querySelector('nav');
if(navToggle && navEl){
  navToggle.addEventListener('click', ()=>{
    const open = navEl.classList.toggle('open');
    navToggle.setAttribute('aria-expanded', open ? 'true' : 'false');
  });
  // close nav when link clicked on small screens
  navEl.querySelectorAll('.container a').forEach(a=>{
    a.addEventListener('click', ()=>{
      if(window.innerWidth <= 880){ navEl.classList.remove('open'); navToggle.setAttribute('aria-expanded','false'); }
    });
  });
  // close on resize if desktop
  window.addEventListener('resize', ()=>{ if(window.innerWidth > 880 && navEl.classList.contains('open')){ navEl.classList.remove('open'); navToggle.setAttribute('aria-expanded','false'); } });
}
</script>

</body>
</html>
